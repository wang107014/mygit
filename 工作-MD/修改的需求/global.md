#global
##医嘱类型：^OECPR

	^OECPR(0)=33
	^OECPR(0,"Code","NORM",3)=""
	^OECPR(0,"Code","OM",6)=""
	^OECPR(0,"Code","OMCQZT",29)=""
	^OECPR(0,"Code","OMLSZT",30)=""
	^OECPR(0,"Code","OMST",8)=""
	^OECPR(0,"Code","ONE",4)=""
	^OECPR(0,"Code","OUT",7)=""
	^OECPR(0,"Code","PRN",2)=""
	^OECPR(0,"Code","S",5)=""
	^OECPR(0,"Code","STAT",1)=""
	^OECPR(0,"Desc","PRN",2)=""
	^OECPR(0,"Desc","临时医嘱",3)=""
	^OECPR(0,"Desc","临时嘱托",30)=""
	^OECPR(0,"Desc","出院带药",7)=""
	^OECPR(0,"Desc","即刻医嘱",1)=""
	^OECPR(0,"Desc","取药医嘱",4)=""
	^OECPR(0,"Desc","自备药即刻",6)=""
	^OECPR(0,"Desc","自备药长期",8)=""
	^OECPR(0,"Desc","长期医嘱",5)=""
	^OECPR(0,"Desc","长期嘱托",29)=""
	^OECPR(1)="STAT^即刻医嘱^0^"
	^OECPR(2)="PRN^PRN^0^"
	^OECPR(3)="NORM^临时医嘱^^"
	^OECPR(4)="ONE^取药医嘱^0^"
	^OECPR(5)="S^长期医嘱^^"
	^OECPR(6)="OM^自备药即刻^0^"
	^OECPR(7)="OUT^出院带药^^"
	^OECPR(8)="OMST^自备药长期^0^"
	^OECPR(29)="OMCQZT^长期嘱托^0^"
	^OECPR(30)="OMLSZT^临时嘱托^0^"


##查询试剂类型 ^OEC("ACT")
	DHC-APP>zw ^OEC("ACT")
	^OEC("ACT",0)=9
	^OEC("ACT",0,"Code","MS",2)=""
	^OEC("ACT",0,"Code","TM",5)=""
	^OEC("ACT",0,"Code","XZ",3)=""
	^OEC("ACT",0,"Code","YY",1)=""
	^OEC("ACT",0,"Desc","免试",2)=""
	^OEC("ACT",0,"Desc","原液",1)=""
	^OEC("ACT",0,"Desc","续注",3)=""
	^OEC("ACT",0,"Desc","脱敏",5)=""
	^OEC("ACT",1)="YY^原液^61538^"
	^OEC("ACT",2)="MS^免试^61538^"
	^OEC("ACT",3)="XZ^续注^63019^"
	^OEC("ACT",5)="TM^脱敏^64345^"

##查看医嘱执行状态 ^OEC("OSTAT")
	DHC-APP>zw ^OEC("OSTAT")
	^OEC("OSTAT",0)=33
	^OEC("OSTAT",0,"Code","C",12)=""
	^OEC("OSTAT",0,"Code","D",4)=""
	^OEC("OSTAT",0,"Code","E",6)=""
	^OEC("OSTAT",0,"Code","H",3)=""
	^OEC("OSTAT",0,"Code","I",10)=""
	^OEC("OSTAT",0,"Code","IP",11)=""
	^OEC("OSTAT",0,"Code","P",5)=""
	^OEC("OSTAT",0,"Code","PO",8)=""
	^OEC("OSTAT",0,"Code","Q",7)=""
	^OEC("OSTAT",0,"Code","S",9)=""
	^OEC("OSTAT",0,"Code","U",2)=""
	^OEC("OSTAT",0,"Code","UD",33)=""
	^OEC("OSTAT",0,"Code","V",1)=""
	^OEC("OSTAT",0,"Desc","INQUEUE",7)=""
	^OEC("OSTAT",0,"Desc","ONHOLD",3)=""
	^OEC("OSTAT",0,"Desc","POSTOPERATIONORDER",8)=""
	^OEC("OSTAT",0,"Desc","POSTPONED",9)=""
	^OEC("OSTAT",0,"Desc","作废",2)=""
	^OEC("OSTAT",0,"Desc","停止",4)=""
	^OEC("OSTAT",0,"Desc","处理中",11)=""
	^OEC("OSTAT",0,"Desc","待审核",33)=""
	^OEC("OSTAT",0,"Desc","执行",6)=""
	^OEC("OSTAT",0,"Desc","撤销",12)=""
	^OEC("OSTAT",0,"Desc","未审核",10)=""
	^OEC("OSTAT",0,"Desc","核实",1)=""
	^OEC("OSTAT",0,"Desc","预开",5)=""
	^OEC("OSTAT",1)="V^核实^Y"
	^OEC("OSTAT",2)="U^作废^Y"
	^OEC("OSTAT",3)="H^On Hold^"
	^OEC("OSTAT",4)="D^停止^Y"
	^OEC("OSTAT",5)="P^预开^Y"
	^OEC("OSTAT",6)="E^执行^Y"
	^OEC("OSTAT",7)="Q^In Queue^"
	^OEC("OSTAT",8)="PO^Post-Operation Order^N"
	^OEC("OSTAT",9)="S^Postponed^"
	^OEC("OSTAT",10)="I^未审核^Y"
	^OEC("OSTAT",11)="IP^处理中^Y"
	^OEC("OSTAT",12)="C^撤销^Y"
	^OEC("OSTAT",33)="UD^待审核^Y"

##查看医嘱名称 整包装单位

	DHC-APP>zw ^ARCIM(2111)
	^ARCIM(2111,1,1)="ZCL0004^知名专家门诊诊察费^ZMZJMZZCF^^^N^^^2||1^80^^^64801Z746         08"
	^ARCIM(2111,1,2)="1^^^^^^Y^I^O^"
	^ARCIM(2111,1,3)="^^^^^^^"
	^ARCIM(2111,1,4)="^^^^^^^"
	^ARCIM(2111,1,5)="^^^N"
	^ARCIM(2111,1,6)="^^^^"
	^ARCIM(2111,1,7)="^^^^^S^^^^^^^Y^^^^"
	^ARCIM(2111,1,8)="64803^36184^1^^^^55^^^^N^^^77^^^^^^^^3"
	^ARCIM(2111,1,9)="^^^^^N^^^^^^^^^^^^N^^^^N^N^^N^^^^N^^^^^^^^^^^"
	^ARCIM(2111,1,10)="^^^^^^^^^^^N^N^N^N^^^^^^"
	^ARCIM(2111,1,"OEM",0)=1
	^ARCIM(2111,1,"OEM",1)=""
	^ARCIM(2111,1,"RB",0)=0

	DHC-APP>zw ^ARCIM(136)
	^ARCIM(136,1,1)="XY0136^注射用青霉素钠(0.48g(80万单位)/支)^注射用青霉素钠^^^N^^^                  8||1^2^^136||1^64801,33222Z"
	^ARCIM(136,1,2)="1^^^^^^Y^I^O^"
	^ARCIM(136,1,3)="^^^^^^^"
	^ARCIM(136,1,4)="^^^^^^^"
	^ARCIM(136,1,5)="^^^N"
	^ARCIM(136,1,6)="^^^^"
	^ARCIM(136,1,7)="^^^^^^^^^^^^Y^^^^"
	^ARCIM(136,1,8)="64806^33222^^^^^^^^^N^^^16^^^^^^129^注射用青霉素钠^3"
	^ARCIM(136,1,9)="^^^^^N^^^^^^^^^^^^N^^^^N^N^^N^^^^N^^^^^^^^^^^"
	^ARCIM(136,1,10)="^^^^^^^^^^^N^N^N^N^^^^^^"
	^ARCIM(136,1,"ALG",0)=7
	^ARCIM(136,1,"ALG",7)="^129^"
	^ARCIM(136,1,"OEM",0)=1
	^ARCIM(136,1,"OEM",1)=""
	^ARCIM(136,1,"RB",0)=0

##查询医嘱 处方号 ^OEORD
	DHC-APP>zw ^OEORD(1297)
	^OEORD(1297)="1367^64859^72951^^^^"
	^OEORD(1297,"I",0)=3
	^OEORD(1297,"I",1,1)="^2111||1^20^^A^^^3^64859^72951^^1^1^^^268536||1^72951^^64859^72951"
	^OEORD(1297,"I",1,3)="^^Y^1^B^20^64859^^101100000281^^^^^^^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",1,5)="N^N^^^^^"
	^OEORD(1297,"I",1,7)="7063^20^^"
	^OEORD(1297,"I",1,8)="^^^^^^^^^^^7063^^^^^^^^^^"
	^OEORD(1297,"I",1,9)="^20^^^^^^^^^^^^"
	^OEORD(1297,"I",1,11)="^^^^^^^^^^^^^^^^^1"
	^OEORD(1297,"I",2,1)="^136||1^20^^A^^^3^64859^72975^233^.48^1^O180730000019^1/2^268536||2^72967^1^64859^73009"
	^OEORD(1297,"I",2,2)="0.48^^2^10^^1^7^^^^^^.26^^"
	^OEORD(1297,"I",2,3)="^^N^2^B^84^64859^^101100000281^^^P^^^^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",2,5)="N^Y^^^^^"
	^OEORD(1297,"I",2,7)="7063^20^^"
	^OEORD(1297,"I",2,8)="^^^^^^^^^^^7063^^^^^^^^^^"
	^OEORD(1297,"I",2,9)="^20^^1^^^^^^^^^^"
	^OEORD(1297,"I",2,11)="^^^64859^73009^^^^^^^^^^^^^1^^^1^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^N^^^^^^^^^^^^^"
	^OEORD(1297,"I",2,12)="^^^^^^^^^^^^^^^^^^^^^^^^^N^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",2,"DEP",0)=1
	^OEORD(1297,"I",2,"DEP",1)=""
	^OEORD(1297,"I",2,"DHC")="^^^^^^^^^^^^16^^65||1||3^N^0^^^^^^^^^^^^^^^N^^^^^N^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",2,"REM",0)=1
	^OEORD(1297,"I",2,"REM",1)=""
	^OEORD(1297,"I",2,"X",0)=1
	^OEORD(1297,"I",2,"X",1)="64859^28800^^.48^1^TB^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^64859^73009"
	^OEORD(1297,"I",2,"X",1,"BILL")="1^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",2,"X",1,"SIGN")=1
	^OEORD(1297,"I",3,1)="^136||1^20^^A^^^3^64859^72983^233^1.44^1^O180730000020^2/2^268536||3^72981^3^64859^73009"
	^OEORD(1297,"I",3,2)="0.48^^2^6^^1^1^^^^^^.26^^"
	^OEORD(1297,"I",3,3)="^^N^3^B^84^64859^^101100000281^^^P^^^^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",3,5)="N^N^^^^^"
	^OEORD(1297,"I",3,7)="7063^20^^"
	^OEORD(1297,"I",3,8)="^^^^^^^^^^^7063^^^^^^^^^^"
	^OEORD(1297,"I",3,9)="^20^^3^^^^^^^^^^"
	^OEORD(1297,"I",3,11)="^^^64859^73009^^^^^^^^^^^^^1^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^N^^^^^^^^^^^^^"                                                         ^OEORD(1297,"I",3,12)="^^^^^^^^^^^^^^^^^^^^^^^^^N^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",3,"DEP",0)=1
	^OEORD(1297,"I",3,"DEP",1)=""
	^OEORD(1297,"I",3,"DHC")="^^^^^^^^^^^^16^^65||1||3^N^0^^^^^^^^^^^^^^^N^^^^^N^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",3,"REM",0)=1
	^OEORD(1297,"I",3,"REM",1)=""
	^OEORD(1297,"I",3,"X",0)=3
	^OEORD(1297,"I",3,"X",1)="64859^32400^^.48^3^TB^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^64859^73009"
	^OEORD(1297,"I",3,"X",1,"BILL")="1^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",3,"X",1,"SIGN")=1
	^OEORD(1297,"I",3,"X",2)="64859^43200^^.48^3^TB^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^64859^73009"
	^OEORD(1297,"I",3,"X",2,"BILL")="1^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",3,"X",2,"SIGN")=1
	^OEORD(1297,"I",3,"X",3)="64859^57600^^.48^3^TB^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^64859^73009"
	^OEORD(1297,"I",3,"X",3,"BILL")="1^^^^^^^^^^^^^^^^^^^^^"
	^OEORD(1297,"I",3,"X",3,"SIGN")=1


##查看病人就诊 ^PAADM

	DHC-APP>zw ^PAADM(1367)
	^PAADM(1367)="297^O^^20^^64859^72951^^233^^^^N^^^^^^^A^^^^^^N^^Y^^^^^^64859^72951^N^^^^^64859^72951^7063^^N^^^^^^^^^^^R^^^^^1367^^^^^^^^^^^^^^^^^^^^OP0000000759^^"
	^PAADM(1367,1)="^^^1367^^^1^^^^^^^^N^^^^^^^N^N^^^^^^^^^^^^^^^N^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"
	^PAADM(1367,2)="^^^^^^^^^^^^^^^^^^^^N^^^^N^^^^^^N^^^^^^^^^^^^^^^^4^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^N^^^^^^^^^^^^^^^^^^^"
	^PAADM(1367,3)="^^^^"
	^PAADM(1367,"ADM2")="^^^^^^^^^^^^^^^^^^^^^^^^^李洪^^^^^^^^^^^^^^^^^^^^^^^^^^^^"
	^PAADM(1367,"ADM2","FRCMT",0)=0
	^PAADM(1367,"ADMFIM",0)=0
	^PAADM(1367,"CHADR",0)=0
	^PAADM(1367,"CMT",0)=0
	^PAADM(1367,"CONF",0)=0
	^PAADM(1367,"DEL",0)=0
	^PAADM(1367,"DHC")="^^^^^^^^^20^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"
	^PAADM(1367,"DLN",0)=0
	^PAADM(1367,"INTERV",0)=0
	^PAADM(1367,"PLN",0)=0
	^PAADM(1367,"RAD",0)=0

##费别类型

	DHC-APP>zw ^PAC("ADMREA")
	^PAC("ADMREA",0)=34
	^PAC("ADMREA",0,"Code",10,33)=""
	^PAC("ADMREA",0,"Code",9901,2)=""
	^PAC("ADMREA",0,"Code",9902,3)=""
	^PAC("ADMREA",0,"Code",9903,4)=""
	^PAC("ADMREA",0,"Code",9904,5)=""
	^PAC("ADMREA",0,"Code",9905,7)=""
	^PAC("ADMREA",0,"Code",9906,11)=""
	^PAC("ADMREA",0,"Code",9907,13)=""
	^PAC("ADMREA",0,"Code","001",16)=""
	^PAC("ADMREA",0,"Code","03",6)=""
	^PAC("ADMREA",0,"Code","04",9)=""
	^PAC("ADMREA",0,"Code","05",8)=""
	^PAC("ADMREA",0,"Code","06",10)=""
	^PAC("ADMREA",0,"Code","07",1)=""
	^PAC("ADMREA",0,"Code","08",12)=""
	^PAC("ADMREA",0,"Code","09",32)=""
	^PAC("ADMREA",0,"Code","KYYY",18)=""
	^PAC("ADMREA",0,"Code","ZYKYYY",19)=""
	^PAC("ADMREA",0,"Desc","住院临床药理",19)=""
	^PAC("ADMREA",0,"Desc","全公费",10)=""
	^PAC("ADMREA",0,"Desc","全自费",1)=""
	^PAC("ADMREA",0,"Desc","其他",16)=""
	^PAC("ADMREA",0,"Desc","其他社会保险",12)=""
	^PAC("ADMREA",0,"Desc","商业医疗保险",8)=""
	^PAC("ADMREA",0,"Desc","居民医保",33)=""
	^PAC("ADMREA",0,"Desc","市医保",4)=""
	^PAC("ADMREA",0,"Desc","市慢病",5)=""
	^PAC("ADMREA",0,"Desc","异地医保",7)=""
	^PAC("ADMREA",0,"Desc","新型农村合作医疗",6)=""
	^PAC("ADMREA",0,"Desc","本地医保",2)=""
	^PAC("ADMREA",0,"Desc","本院职工",11)=""
	^PAC("ADMREA",0,"Desc","生育保险",6)=""
	^PAC("ADMREA",0,"Desc","省医保",2)=""
	^PAC("ADMREA",0,"Desc","省慢病",3)=""
	^PAC("ADMREA",0,"Desc","科研",13)=""
	^PAC("ADMREA",0,"Desc","职工医保",32)=""
	^PAC("ADMREA",0,"Desc","贫困救助",9)=""
	^PAC("ADMREA",0,"Desc","门诊临床药理",18)=""
	^PAC("ADMREA",1)="07^全自费^63139^^^^^^^^^^^^^^"
	^PAC("ADMREA",2)="9901^省医保^63139^^1^^^^1^^^^^^^^"
	^PAC("ADMREA",3)="9902^省慢病^63139^^^^^^^^^^^^^"
	^PAC("ADMREA",4)="9903^市医保^63139^^1^^^^1^^^^^^^^"
	^PAC("ADMREA",5)="9904^市慢病^63139^^^^^^^^^^^^^"
	^PAC("ADMREA",6)="03^新型农村合作医疗^63139^^^^^^^^^^^^^^"
	^PAC("ADMREA",7)="9905^异地医保^63139^^^^^^^^^^^^^^"
	^PAC("ADMREA",8)="05^商业医疗保险^63139^^^^^^^^^^^^^"
	^PAC("ADMREA",9)="04^贫困救助^63139^^^^^^^^^^^^^"
	^PAC("ADMREA",10)="06^全公费^63139^^^^^^^^^^^^^^"
	^PAC("ADMREA",11)="9906^本院职工^63139^^^^^^^^^^^^^"
	^PAC("ADMREA",12)="08^其他社会保险^63176^^^^^^^^^^^^^^"
	^PAC("ADMREA",13)="9907^科研^63176^^^^^^^^^^^^^^"
	^PAC("ADMREA",16)="001^其他^63428^^^^^^^^^^^^^^"
	^PAC("ADMREA",18)="KYYY^门诊临床药理^63552^^^^^^^^^^^^^^"
	^PAC("ADMREA",19)=" ZYKYYY^住院临床药理^63552^^^^^^^^^^^^^^"
	^PAC("ADMREA",32)="09^职工医保^64471^^^^^^^^^^^^^^"
	^PAC("ADMREA",33)="10^居民医保^64471^^^^^^^^^^^^^^"



##根据进程号获取结算及参数信息 ^TMPDHCOPBILL

	set InsTypeDR=$g(^TMPDHCOPBILL("Charge",Job,"ChargeLog","InsType"))
	set InsType=$p($g(^PAC("ADMREA",+InsTypeDR)),"^",2)
	set PayNum=$g(^TMPDHCOPBILL("Charge",Job,"ChargeLog","Count"))	
	set PaySum=$g(^TMPDHCOPBILL("Charge",Job,"ChargeLog","PatPaySum"))		;支付总费用
	set PatNum=$g(^TMPDHCOPBILL("Charge",Job,"ReBillLog","Count"))
	set PatShareAmt=$g(^TMPDHCOPBILL("Charge",Job,"ReBillLog","PatShareAmt"))
	set ExpStr=$g(^TMPDHCOPBILL("Charge",Job,"ChargeLog","ExpStr"))	